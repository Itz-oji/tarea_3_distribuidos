syntax = "proto3";

package heint;

option go_package = "/proto;proto";

message Response {
    string mensaje = 1;
}
message AsientoSelect {
    string asientoID = 1;
    string asiento =2;
}
message FactBaggage {
    string BaggageID = 1;
    string Baggage = 2;
}
message SolicitudEstado {
    string cliente = 1;
}
message RequestAsignar {
    string cliente = 1;
}
message ResponseAsignar {
    string datanode = 1;
}
message ResponseEstadoAsignado {
    string datanode = 1;
    string idSistema = 2;
    map<string,bool> asientos = 3;
}
message Estado {
    string id = 1;
    map<string, bool> asientos_disponibles = 2;    
}
service BrokerService {
    // Recibe una oferta de un productor
    rpc SendOffer (Response) returns (Response);
    rpc SendEstado (Response) returns (Estado);
    rpc SendReserva (AsientoSelect) returns (Response);
    rpc SendBaggage (FactBaggage) returns (Response);
    rpc ObtenerEstadoYAsignacion(SolicitudEstado) returns (ResponseEstadoAsignado);
}
service DataNodeService {
    rpc ObtenerEstado (SolicitudEstado) returns (ResponseEstadoAsignado);
    rpc EscribirReserva (AsientoSelect) returns (Response);
}
service AsignadorService {
    rpc AsignarDataNode(RequestAsignar) returns (ResponseAsignar);
    rpc ObtenerEstadoYAsignacion(SolicitudEstado) returns (ResponseEstadoAsignado);
}